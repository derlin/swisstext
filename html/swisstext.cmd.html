
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Commandline tools &#8212; SwissText  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scraping commandline tool" href="swisstext.cmd.scraping.html" />
    <link rel="prev" title="MongoDB Collections definitions" href="swisstext.mongo.abstract.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="swisstext.cmd.scraping.html" title="Scraping commandline tool"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="swisstext.mongo.abstract.html" title="MongoDB Collections definitions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SwissText  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="apireference.html" accesskey="U">API Reference</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-swisstext.cmd">
<span id="commandline-tools"></span><h1>Commandline tools<a class="headerlink" href="#module-swisstext.cmd" title="Permalink to this headline">¶</a></h1>
<p>This package contains everything for running the SwissText Scraping logic.</p>
<p>It is implemented using two command-line programs, each in its own package:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">st_scrape</span></code> defined in <a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping" title="swisstext.cmd.scraping"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.scraping</span></code></a>, is used to scrape URLs and detect/save Swiss German sentences,</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">st_search</span></code> defined in <a class="reference internal" href="swisstext.cmd.searching.html#module-swisstext.cmd.searching" title="swisstext.cmd.searching"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.searching</span></code></a>, is used to do submit search queries using seeds and gather</dt><dd><p>new URLs to scrape</p>
</dd>
</dl>
</li>
</ul>
<p>After installing the package, here is an example use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">## To use this script, create a directory and create the following files:</span>
<span class="c1">##  * configuration files: searching.yaml and scraping.yaml (see the doc)</span>
<span class="c1">##  * bootstrap files: base_seeds.txt, one seed per line to start with</span>

<span class="nb">set</span> -e
<span class="nb">trap</span> <span class="nb">exit</span> SIGINT

<span class="nv">base_dir</span><span class="o">=</span>.  <span class="c1"># relative link to the base directory</span>

<span class="nv">st_search</span><span class="o">=</span><span class="s2">&quot;st_search -c </span><span class="nv">$base_dir</span><span class="s2">/searching.yaml&quot;</span>
<span class="nv">st_scrape</span><span class="o">=</span><span class="s2">&quot;st_scrape -c </span><span class="nv">$base_dir</span><span class="s2">/scraping.yaml&quot;</span>

<span class="c1"># search for the bootstrap seeds</span>
<span class="nv">$st_search</span> from_file <span class="nv">$base_dir</span>/base_seeds.txt

<span class="c1"># do five loops. Each loop: (a) scrapes the new URLs, (b) generates random seeds, (c) use the new seeds</span>
<span class="k">for</span> i in <span class="k">$(</span>seq <span class="m">1</span> <span class="m">5</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&quot;======= START LOOP&quot;</span>
    <span class="c1"># scrape at most 30 new urls</span>
    <span class="nv">$st_scrape</span> --no-seed from_mongo --new -n <span class="m">30</span>
    <span class="nb">echo</span> <span class="s2">&quot;======= generating SEEDS&quot;</span>
    <span class="c1"># generate three random seeds, each time from 150 randomly picked sentences</span>
    <span class="nv">$st_scrape</span> gen_seeds -s <span class="m">150</span> -n <span class="m">1</span>
    <span class="nv">$st_scrape</span> gen_seeds -s <span class="m">150</span> -n <span class="m">1</span>
    <span class="nv">$st_scrape</span> gen_seeds -s <span class="m">150</span> -n <span class="m">1</span>
    <span class="nb">echo</span> <span class="s2">&quot;======= searching SEEDS&quot;</span>
    <span class="c1"># search URLs using the newly generated seeds</span>
    <span class="nv">$st_search</span> from_mongo --new -n <span class="m">3</span>
<span class="k">done</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="admonition-title">Todo</p>
<p>add pipeline schema</p>
</div>
<div class="section" id="available-commands">
<h2>Available commands<a class="headerlink" href="#available-commands" title="Permalink to this headline">¶</a></h2>
<p>Two commands are available, each in it own subpackage.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="swisstext.cmd.scraping.html">Scraping commandline tool</a><ul>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.scraping.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping.interfaces">Tool interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.scraping.html#tool-implementations">Tool implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="swisstext.cmd.scraping.tools.html">Command line scraping tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.basic_decider">Deciders</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.basic_seed_creator">Seed Creators</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.bs_crawler">Crawlers</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.console_saver">Savers</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.pattern_sentence_filter">Sentence Filters</a><ul>
<li class="toctree-l5"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#how-it-works">How it works</a></li>
<li class="toctree-l5"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#rule-syntax">Rule syntax</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.punkt_splitter">Splitters</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.scraping.tools.html#module-swisstext.cmd.scraping.tools.swigspot_langid">Language Detectors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping.config">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping.data">Pipeline implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="swisstext.cmd.searching.html">Searching commandline tool</a><ul>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.searching.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.searching.html#module-swisstext.cmd.searching.interfaces">Tool interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.searching.html#tool-implementations">Tool implementations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="swisstext.cmd.searching.tools.html">Command line searching tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.searching.tools.html#module-swisstext.cmd.searching.tools.console_saver">Savers</a></li>
<li class="toctree-l4"><a class="reference internal" href="swisstext.cmd.searching.tools.html#module-swisstext.cmd.searching.tools.google_search">Searchers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="swisstext.cmd.searching.tools.html#example-usages">Example usages</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.searching.html#module-swisstext.cmd.searching.config">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="swisstext.cmd.searching.html#module-swisstext.cmd.searching.data">Pipeline implementation</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="module-swisstext.cmd.base_config">
<span id="configuration-files"></span><h2>Configuration files<a class="headerlink" href="#module-swisstext.cmd.base_config" title="Permalink to this headline">¶</a></h2>
<p>This module encapsulates all the configuration needed to run a multi-steps toolchain.
It is used by both commandline tools.</p>
<p>Config objects can easily be populated from a YAML configuration file. This file should have the following structure:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># This entry defines general options that will be stored in :py:attr:`BaseConfig.options`.</span>
<span class="nt">options</span><span class="p">:</span>
  <span class="nt">key1</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">value1</span>

<span class="c1"># This entry defines tools to instantiate</span>
<span class="c1"># the actual name is specified in the subclass by overriding :py:attr:`BaseConfig.tool_entry_name`</span>
<span class="c1"># valid interface names are specified in the sublcass by overriding :py:attr:`valid_tool_entries`</span>
<span class="nt">tool_entry_name</span><span class="p">:</span>
    <span class="c1"># optional default package for relative entries</span>
    <span class="nt">_base_package</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">some.default.module</span>
    <span class="c1"># list of tools</span>
    <span class="nt">interface_name_1</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">absolute.module.ToolClassName1</span>
    <span class="nt">interface_name_2</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.ToolClassName2</span> <span class="c1"># will be expanded to some.default.module.ToolClassName2</span>

<span class="c1"># any entry in the form [interface_name]_options defines options that will be passed to the</span>
<span class="c1"># tool class upon construction. Here, for example, the actual instantiation will be:</span>
<span class="c1">#    absolute.module.ToolClassName1(param_1=some_value, param_X=some_other_value)</span>
<span class="nt">interface_name_1_options</span><span class="p">:</span>
    <span class="nt">param_1</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">some_value</span>
    <span class="nt">param_X</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">some_other_value</span>
</pre></div>
</div>
<dl class="class">
<dt id="swisstext.cmd.base_config.BaseConfig">
<em class="property">class </em><code class="descclassname">swisstext.cmd.base_config.</code><code class="descname">BaseConfig</code><span class="sig-paren">(</span><em>default_config_path: str</em>, <em>option_class: classmethod = &lt;class 'dict'&gt;</em>, <em>config: Union[str</em>, <em>dict</em>, <em>io.IOBase] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/cmd/base_config.html#BaseConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>This class encapsulates the configuration options of a toolchain. It is able to load options from YAML files
and also to instantiate tools from a dictionary of module+class names.</p>
<dl class="method">
<dt id="swisstext.cmd.base_config.BaseConfig.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>prop_name</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/cmd/base_config.html#BaseConfig.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value from the YAML configuration file. This method supports paths with “.”, for example:</p>
<ul class="simple">
<li><p><cite>options</cite>: returns the top-level “options”</p></li>
<li><p><cite>tool_entry.tool_name</cite>: return the value of tool_name under tool_entry</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prop_name</strong> – the path of the property to retrieve</p></li>
<li><p><strong>default</strong> – the default value if the property is not found</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the property value or <cite>default</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="swisstext.cmd.base_config.BaseConfig.instantiate_tools">
<code class="descname">instantiate_tools</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[object]<a class="reference internal" href="_modules/swisstext/cmd/base_config.html#BaseConfig.instantiate_tools"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.instantiate_tools" title="Permalink to this definition">¶</a></dt>
<dd><p>For each <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.valid_tool_entries" title="swisstext.cmd.base_config.BaseConfig.valid_tool_entries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">valid_tool_entries</span></code></a> under <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.tool_entry_name" title="swisstext.cmd.base_config.BaseConfig.tool_entry_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tool_entry_name</span></code></a>, try to create an instance.
In case a tool is not defined and <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.interfaces_package" title="swisstext.cmd.base_config.BaseConfig.interfaces_package"><code class="xref py py-attr docutils literal notranslate"><span class="pre">interfaces_package</span></code></a> is not None,
it will try to instantiate the tool name interface instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of tool instances, in the same order as <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.interfaces_package" title="swisstext.cmd.base_config.BaseConfig.interfaces_package"><code class="xref py py-attr docutils literal notranslate"><span class="pre">interfaces_package</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><strong>RuntimeError</strong></a> – if a tool could not be instantiated</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.cmd.base_config.BaseConfig.interfaces_package">
<code class="descname">interfaces_package</code><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.interfaces_package" title="Permalink to this definition">¶</a></dt>
<dd><p>Should return the complete package where the interfaces are defined, if any.
In case this is defined and a tool is missing from the list, we will try to instantiate
the interface instead.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.cmd.base_config.BaseConfig.merge_dicts">
<em class="property">classmethod </em><code class="descname">merge_dicts</code><span class="sig-paren">(</span><em>default</em>, <em>overrides</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/cmd/base_config.html#BaseConfig.merge_dicts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.merge_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge <code class="docutils literal notranslate"><span class="pre">override</span></code> into <code class="docutils literal notranslate"><span class="pre">default</span></code> recursively.
As the names suggest, if an entry is defined in both, the value in <code class="docutils literal notranslate"><span class="pre">overrides</span></code> takes precedence.</p>
</dd></dl>

<dl class="method">
<dt id="swisstext.cmd.base_config.BaseConfig.set">
<code class="descname">set</code><span class="sig-paren">(</span><em>prop_name</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/cmd/base_config.html#BaseConfig.set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a value using the property dot syntax. See <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.get" title="swisstext.cmd.base_config.BaseConfig.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a> to see how it works.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.cmd.base_config.BaseConfig.tool_entry_name">
<code class="descname">tool_entry_name</code><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.tool_entry_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Should return the name of the tool_entries option, i.e. the YAML path to the dictionary of
[interface name, canonical class to instantiate].</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.cmd.base_config.BaseConfig.valid_tool_entries">
<code class="descname">valid_tool_entries</code><a class="headerlink" href="#swisstext.cmd.base_config.BaseConfig.valid_tool_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Should return the list of valid tool entries under the <a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.tool_entry_name" title="swisstext.cmd.base_config.BaseConfig.tool_entry_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tool_entry_name</span></code></a>.
Note that the order of tools in the list defines the order of tools instances returned by
<a class="reference internal" href="#swisstext.cmd.base_config.BaseConfig.instantiate_tools" title="swisstext.cmd.base_config.BaseConfig.instantiate_tools"><code class="xref py py-meth docutils literal notranslate"><span class="pre">instantiate_tools()</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swisstext.cmd.link_utils">
<span id="link-utilities"></span><h2>Link utilities<a class="headerlink" href="#module-swisstext.cmd.link_utils" title="Permalink to this headline">¶</a></h2>
<p>This module provides utilities to deal with links.</p>
<div class="section" id="dealing-with-links-in-a-page">
<h3>Dealing with links in a page<a class="headerlink" href="#dealing-with-links-in-a-page" title="Permalink to this headline">¶</a></h3>
<p>By simply extracting all the <code class="docutils literal notranslate"><span class="pre">href</span></code> attributes in a HTML page, we might end up with a rather large list of
children, not all of them interesting to crawl. Indded, this list would probably contain:</p>
<ul class="simple">
<li><p>duplicates (or different links pointing to the same page but another anchor),</p></li>
<li><p>anchors,</p></li>
<li><p>javascript (<code class="docutils literal notranslate"><span class="pre">javascript:</span></code>),</p></li>
<li><p>pointers to images, PDFs or other non-text resources,</p></li>
<li><p>etc.</p></li>
</ul>
<p>As every implementation of <a class="reference internal" href="swisstext.cmd.scraping.html#swisstext.cmd.scraping.interfaces.ICrawler" title="swisstext.cmd.scraping.interfaces.ICrawler"><code class="xref py py-class docutils literal notranslate"><span class="pre">swisstext.cmd.scraping.interfaces.ICrawler</span></code></a> has to do the job of filtering
this list, we might as well provide a general way to do so.</p>
</div>
<div class="section" id="dealing-with-search-results">
<h3>Dealing with search results<a class="headerlink" href="#dealing-with-search-results" title="Permalink to this headline">¶</a></h3>
<p>When querying Google or another search engine for results, returned URLs might point to PDFs, videos or other
uninteresting websites. The <a class="reference internal" href="#swisstext.cmd.link_utils.is_url_interesting" title="swisstext.cmd.link_utils.is_url_interesting"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_url_interesting()</span></code></a> method is here to help filtering out those “bad” results.</p>
<dl class="data">
<dt id="swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS">
<code class="descclassname">swisstext.cmd.link_utils.</code><code class="descname">EXCLUDED_EXTENSIONS</code><em class="property"> = {'3dv': True, '3g2': True, '3gp': True, 'ai': True, 'amf': True, 'amv': True, 'art': True, 'ase': True, 'asf': True, 'avi': True, 'awg': True, 'blp': True, 'bmp': True, 'bw': True, 'cd5': True, 'cdr': True, 'cgm': True, 'cit': True, 'cmx': True, 'cpt': True, 'cr2': True, 'cur': True, 'cut': True, 'dds': True, 'dib': True, 'djvu': True, 'doc': True, 'docx': True, 'drc': True, 'dxf': True, 'e2d': True, 'ecw': True, 'egt': True, 'emf': True, 'eps': True, 'exif': True, 'f4a': True, 'f4b': True, 'f4p': True, 'f4v': True, 'flv': True, 'fs': True, 'gbr': True, 'gif': True, 'gifv': True, 'gpl': True, 'grf': True, 'hdp': True, 'icns': True, 'ico': True, 'iff': True, 'int': True, 'inta': True, 'jfif': True, 'jng': True, 'jp2': True, 'jpeg': True, 'jpg': True, 'jps': True, 'jxr': True, 'lbm': True, 'liff': True, 'm2v': True, 'm4p': True, 'm4v': True, 'max': True, 'miff': True, 'mkv': True, 'mng': True, 'mov': True, 'mp2': True, 'mp4': True, 'mpe': True, 'mpeg': True, 'mpg': True, 'mpv': True, 'msp': True, 'mxf': True, 'nitf': True, 'nrrd': True, 'nsv': True, 'odg': True, 'ogg': True, 'ogv': True, 'ota': True, 'pam': True, 'pbm': True, 'pc1': True, 'pc2': True, 'pc3': True, 'pcf': True, 'pct': True, 'pcx': True, 'pdd': True, 'pdf': True, 'pdn': True, 'pgf': True, 'pgm': True, 'pi1': True, 'pi2': True, 'pi3': True, 'pict': True, 'png': True, 'pnm': True, 'pns': True, 'ppm': True, 'ppt': True, 'pptx': True, 'psb': True, 'psd': True, 'psp': True, 'px': True, 'pxm': True, 'pxr': True, 'qfx': True, 'qt': True, 'ras': True, 'raw': True, 'rgb': True, 'rgba': True, 'rle': True, 'rm': True, 'rmvb': True, 'roq': True, 'sct': True, 'sgi': True, 'sid': True, 'stl': True, 'sun': True, 'svg': True, 'svi': True, 'sxd': True, 'tga': True, 'tif': True, 'tiff': True, 'v2d': True, 'vnd': True, 'vob': True, 'vrml': True, 'vtf': True, 'wdp': True, 'webm': True, 'webp': True, 'wmf': True, 'wmv': True, 'x3d': True, 'xar': True, 'xbm': True, 'xcf': True, 'xls': True, 'xlsx': True, 'xpm': True, 'yuv': True}</em><a class="headerlink" href="#swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick lookup dictionary to exclude URLs with an extensions typical of non text resources</p>
</dd></dl>

<dl class="data">
<dt id="swisstext.cmd.link_utils.EXCLUDED_TLDS">
<code class="descclassname">swisstext.cmd.link_utils.</code><code class="descname">EXCLUDED_TLDS</code><em class="property"> = {'ac': True, 'ad': True, 'ae': True, 'af': True, 'ag': True, 'ai': True, 'al': True, 'am': True, 'an': True, 'ao': True, 'aq': True, 'ar': True, 'as': True, 'at': True, 'au': True, 'aw': True, 'ax': True, 'az': True, 'ba': True, 'bb': True, 'bd': True, 'be': True, 'bf': True, 'bg': True, 'bh': True, 'bi': True, 'bj': True, 'bl': True, 'bm': True, 'bn': True, 'bo': True, 'bq': True, 'br': True, 'bs': True, 'bt': True, 'bv': True, 'bw': True, 'by': True, 'bz': True, 'ca': True, 'cat': True, 'cc': True, 'cd': True, 'cf': True, 'cg': True, 'ci': True, 'ck': True, 'cl': True, 'cm': True, 'cn': True, 'co': True, 'cr': True, 'cu': True, 'cv': True, 'cw': True, 'cx': True, 'cy': True, 'cz': True, 'dj': True, 'dk': True, 'dm': True, 'do': True, 'dz': True, 'ec': True, 'ee': True, 'eg': True, 'eh': True, 'er': True, 'es': True, 'et': True, 'eus': True, 'fi': True, 'fj': True, 'fk': True, 'fm': True, 'fo': True, 'ga': True, 'gal': True, 'gd': True, 'ge': True, 'gf': True, 'gg': True, 'gh': True, 'gi': True, 'gl': True, 'gm': True, 'gn': True, 'gp': True, 'gq': True, 'gr': True, 'gs': True, 'gt': True, 'gu': True, 'gw': True, 'gy': True, 'hk': True, 'hm': True, 'hn': True, 'hr': True, 'ht': True, 'hu': True, 'id': True, 'ie': True, 'il': True, 'im': True, 'in': True, 'io': True, 'iq': True, 'ir': True, 'is': True, 'je': True, 'jm': True, 'jo': True, 'jp': True, 'ke': True, 'kg': True, 'kh': True, 'ki': True, 'km': True, 'kn': True, 'kp': True, 'kr': True, 'kw': True, 'ky': True, 'kz': True, 'la': True, 'lb': True, 'lc': True, 'li': True, 'lk': True, 'lr': True, 'ls': True, 'lt': True, 'lu': True, 'lv': True, 'ly': True, 'ma': True, 'mc': True, 'md': True, 'me': True, 'mf': True, 'mg': True, 'mh': True, 'mk': True, 'ml': True, 'mm': True, 'mn': True, 'mo': True, 'mp': True, 'mq': True, 'mr': True, 'ms': True, 'mt': True, 'mu': True, 'mv': True, 'mw': True, 'mx': True, 'my': True, 'mz': True, 'na': True, 'nc': True, 'ne': True, 'nf': True, 'ng': True, 'ni': True, 'nl': True, 'no': True, 'np': True, 'nr': True, 'nu': True, 'nz': True, 'om': True, 'pa': True, 'pe': True, 'pf': True, 'pg': True, 'ph': True, 'pk': True, 'pl': True, 'pm': True, 'pn': True, 'pr': True, 'ps': True, 'pt': True, 'pw': True, 'py': True, 'qa': True, 're': True, 'ro': True, 'rs': True, 'ru': True, 'rw': True, 'sa': True, 'sb': True, 'sc': True, 'sd': True, 'se': True, 'sg': True, 'sh': True, 'si': True, 'sj': True, 'sk': True, 'sl': True, 'sm': True, 'sn': True, 'so': True, 'sr': True, 'ss': True, 'st': True, 'sv': True, 'sx': True, 'sy': True, 'sz': True, 'tc': True, 'td': True, 'tf': True, 'tg': True, 'th': True, 'tj': True, 'tk': True, 'tl': True, 'tm': True, 'tn': True, 'to': True, 'tp': True, 'tr': True, 'tt': True, 'tv': True, 'tw': True, 'tz': True, 'ua': True, 'ug': True, 'uy': True, 'uz': True, 'va': True, 'vc': True, 've': True, 'vg': True, 'vi': True, 'vn': True, 'vu': True, 'wf': True, 'ws': True, 'ye': True, 'yt': True, 'za': True, 'zm': True, 'zw': True}</em><a class="headerlink" href="#swisstext.cmd.link_utils.EXCLUDED_TLDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick lookup dictionary to exclude URLs from any country code TLDs except a rare list of pertinent ones (.ch, .eu, .de …).
See <a class="reference external" href="https://gist.github.com/derlin/421d2bb55018a1538271227ff6b1299d">this gist</a> for the source of the list.</p>
</dd></dl>

<dl class="data">
<dt id="swisstext.cmd.link_utils.INCLUDED_WIKI_DOMAINS">
<code class="descclassname">swisstext.cmd.link_utils.</code><code class="descname">INCLUDED_WIKI_DOMAINS</code><em class="property"> = {'als': True}</em><a class="headerlink" href="#swisstext.cmd.link_utils.INCLUDED_WIKI_DOMAINS" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick lookup dictionary to exclude any URL from wikipedia, except the ones from the given subdomains.
See <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_Wikipedias">https://en.wikipedia.org/wiki/List_of_Wikipedias</a> for a full list of wikipedia subdomains.</p>
</dd></dl>

<dl class="function">
<dt id="swisstext.cmd.link_utils.filter_links">
<code class="descclassname">swisstext.cmd.link_utils.</code><code class="descname">filter_links</code><span class="sig-paren">(</span><em>base_url: str, links: Iterable[str]</em><span class="sig-paren">)</span> &#x2192; Generator[[str, None], None]<a class="reference internal" href="_modules/swisstext/cmd/link_utils.html#filter_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.link_utils.filter_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolve, clean and filter links found in a page. By links we mean here any value of <cite>href</cite> attribute found
in a page. This is especially useful for the
<code class="xref py py-class docutils literal notranslate"><span class="pre">swisstext.cmd.scraping.interface.ICrawler</span></code> to constitute and populate the crawl results’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">links</span></code> attribute.</p>
<p>In addition to transforming relative to absolute URLs, this method will also exclude:</p>
<ul class="simple">
<li><p>the base URL</p></li>
<li><p>non HTTP links (<cite>mailto:</cite>, <cite>javascript:</cite>, anchors, …)</p></li>
<li><p>Duplicates</p></li>
<li><p>URLs pointing to non text resources (see <a class="reference internal" href="#swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS" title="swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS"><code class="xref py py-const docutils literal notranslate"><span class="pre">EXCLUDED_EXTENSIONS</span></code></a>)</p></li>
<li><p>URLs with a Country Code TLD unlikely to contain Swiss German (see <a class="reference internal" href="#swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS" title="swisstext.cmd.link_utils.EXCLUDED_EXTENSIONS"><code class="xref py py-const docutils literal notranslate"><span class="pre">EXCLUDED_EXTENSIONS</span></code></a>)</p></li>
</ul>
<p>For two links to be considered duplicates, they need to match exactly. Exceptions are anchors (stripped
automatically from the URL) and trailing slashes (in this case, the first encountered link will be returned).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">swisstext.cmd.scraping.link_utils</span> <span class="kn">import</span> <span class="n">filter_links</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;http://example.ch/page/1&#39;</span>
<span class="n">hrefs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;#&#39;</span><span class="p">,</span>
    <span class="s2">&quot;whatsapp://send?text=Dumoulin verlangt naar&quot;</span><span class="p">,</span>
    <span class="s1">&#39;../other/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;../other#anchor&#39;</span><span class="p">,</span>
    <span class="s1">&#39;?page=2&amp;q=isch&#39;</span><span class="p">,</span>
    <span class="s1">&#39;?page=2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://imgur.org/some-image.png&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://ru.wikipedia.org/wiki&#39;</span><span class="p">,</span>
    <span class="s1">&#39;https://als.wikipedia.org&#39;</span><span class="p">,</span>
    <span class="s1">&#39;http://other.resource.test&#39;</span><span class="p">,</span>
    <span class="s1">&#39;javascript:return false&#39;</span>
<span class="p">]</span>
<span class="n">links</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">filter_links</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">hrefs</span><span class="p">))</span>

<span class="c1"># links contain:</span>
<span class="c1">#  http://example.ch/other/</span>
<span class="c1">#  http://example.ch/page/1?page=2&amp;q=isch</span>
<span class="c1">#  http://example.ch/page/1?page=2</span>
<span class="c1">#  https://als.wikipedia.org</span>
<span class="c1">#  http://other.resource.test</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_url</strong> – the URL of the current page (not returned and used to resolve relative links).</p></li>
<li><p><strong>links</strong> – a list of links found, relative or absolute</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a generator of unique absolute URLs, all beginning with <cite>http</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="swisstext.cmd.link_utils.is_url_interesting">
<code class="descclassname">swisstext.cmd.link_utils.</code><code class="descname">is_url_interesting</code><span class="sig-paren">(</span><em>url: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/swisstext/cmd/link_utils.html#is_url_interesting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.cmd.link_utils.is_url_interesting" title="Permalink to this definition">¶</a></dt>
<dd><p>Test is an absolute URL is interesting to crawl.</p>
<p>The decision will be based on criteria such as the extension (exclude PDFs, images, etc.),
the TLD (exclude some country-specific TLDs) or the domain (exclude some wikipedia links)…</p>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Commandline tools</a><ul>
<li><a class="reference internal" href="#available-commands">Available commands</a></li>
<li><a class="reference internal" href="#module-swisstext.cmd.base_config">Configuration files</a></li>
<li><a class="reference internal" href="#module-swisstext.cmd.link_utils">Link utilities</a><ul>
<li><a class="reference internal" href="#dealing-with-links-in-a-page">Dealing with links in a page</a></li>
<li><a class="reference internal" href="#dealing-with-search-results">Dealing with search results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="swisstext.mongo.abstract.html"
                        title="previous chapter">MongoDB Collections definitions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="swisstext.cmd.scraping.html"
                        title="next chapter">Scraping commandline tool</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/swisstext.cmd.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="swisstext.cmd.scraping.html" title="Scraping commandline tool"
             >next</a> |</li>
        <li class="right" >
          <a href="swisstext.mongo.abstract.html" title="MongoDB Collections definitions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SwissText  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="apireference.html" >API Reference</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Lucy Linder.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>