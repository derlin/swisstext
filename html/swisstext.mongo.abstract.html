
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>MongoDB Collections definitions &#8212; SwissText  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Commandline tools" href="swisstext.cmd.html" />
    <link rel="prev" title="MongoEngine - MongoDB package" href="swisstext.mongo.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="swisstext.cmd.html" title="Commandline tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="swisstext.mongo.html" title="MongoEngine - MongoDB package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SwissText  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="apireference.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="swisstext.mongo.html" accesskey="U">MongoEngine - MongoDB package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-swisstext.mongo.abstract">
<span id="mongodb-collections-definitions"></span><h1>MongoDB Collections definitions<a class="headerlink" href="#module-swisstext.mongo.abstract" title="Permalink to this headline">¶</a></h1>
<p>This module contains abstract <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a> definitions for all the objects in the SwissText system
database.</p>
<p>When using mongoengine directly, you can use the concrete classes defined in <a class="reference internal" href="swisstext.mongo.html#module-swisstext.mongo.models" title="swisstext.mongo.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.mongo.models</span></code></a>.</p>
<p>When using Flask-MongoEngine, just subclass all abstract classes (i.e. the ones prefixed with <cite>Abstract</cite>)
and make them inherit from <code class="docutils literal notranslate"><span class="pre">db.Document</span></code> as well. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_mongoengine</span> <span class="kn">import</span> <span class="n">MongoEngine</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">MongoEngine</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">swisstext.mongo.abstract</span> <span class="kn">import</span> <span class="n">AbstractMongoURL</span>

<span class="k">class</span> <span class="nc">MongoURL</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Document</span><span class="p">,</span> <span class="n">AbstractMongoURL</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="section" id="module-swisstext.mongo.abstract.generic">
<span id="common-structures-and-embedded-documents"></span><h2>Common structures and embedded documents<a class="headerlink" href="#module-swisstext.mongo.abstract.generic" title="Permalink to this headline">¶</a></h2>
<p>Define generic/reused embedded documents as well as constants.</p>
<dl class="class">
<dt id="swisstext.mongo.abstract.generic.CrawlMeta">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.generic.</code><code class="descname">CrawlMeta</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/generic.html#CrawlMeta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.generic.CrawlMeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.EmbeddedDocument</span></code></p>
<p>Holds a date and a count of items</p>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.CrawlMeta.count">
<code class="descname">count</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.CrawlMeta.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Items count, for example the number of new URLs found.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.CrawlMeta.date">
<code class="descname">date</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.CrawlMeta.date" title="Permalink to this definition">¶</a></dt>
<dd><p>The creation/added date, in UTC.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.generic.Deleted">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.generic.</code><code class="descname">Deleted</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/generic.html#Deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.generic.Deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.EmbeddedDocument</span></code></p>
<p>A deleted flag.</p>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.Deleted.by">
<code class="descname">by</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.Deleted.by" title="Permalink to this definition">¶</a></dt>
<dd><p>The ID of the user triggering deletion, required !</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.Deleted.comment">
<code class="descname">comment</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.Deleted.comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional, not recorded to the DB if not specified</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.Deleted.date">
<code class="descname">date</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.Deleted.date" title="Permalink to this definition">¶</a></dt>
<dd><p>The datetime, generated automatically on creation in UTC</p>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="swisstext.mongo.abstract.generic.Dialects">
<code class="descclassname">swisstext.mongo.abstract.generic.</code><code class="descname">Dialects</code><em class="property"> = {'a_l_z': 'Aargau, Luzern, Zug Nord', 'ba_sn': 'Basel, Solothurn Nord', 'bo_fr': 'Berner Oberland, Freiburg', 'g_sgs': 'Glarus und SG Süd', 'graub': 'Graubünden', 'nords': 'Nordostschweiz (SH, TG, SG Nord, AR, AI)', 'ss_bn': 'Solothurn Süd, Bern Nord', 'walli': 'Wallis', 'zentr': 'Zentralschweiz (OW, NW, UR, SZ, ZG Süd)', 'zuric': 'Zürich'}</em><a class="headerlink" href="#swisstext.mongo.abstract.generic.Dialects" title="Permalink to this definition">¶</a></dt>
<dd><p>An ordered dictionary of available dialect tags.
The dialect tags come from the Master Thesis of Sandra Kellerhals,
“<em>Dialektometrische Analyse und Visualisierung von schweizerdeutschen Dialekten auf verschiedenen linguistischen Ebenen</em>”,
p. 62 (see category <em>Alle SDS- und SADS- Daten 10 Dialektregionen</em>)</p>
</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.generic.Source">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.generic.</code><code class="descname">Source</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/generic.html#Source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.generic.Source" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.EmbeddedDocument</span></code></p>
<p>A source field. It contains two informations:
<a class="reference internal" href="#swisstext.mongo.abstract.generic.Source.type_" title="swisstext.mongo.abstract.generic.Source.type_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type_</span></code></a> (mapped to <cite>type</cite> in mongo), one of the <a class="reference internal" href="#swisstext.mongo.abstract.generic.SourceType" title="swisstext.mongo.abstract.generic.SourceType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceType</span></code></a> above and
<a class="reference internal" href="#swisstext.mongo.abstract.generic.Source.extra" title="swisstext.mongo.abstract.generic.Source.extra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">extra</span></code></a> for an optional extra information.</p>
<dl class="docutils">
<dt>If the source is attached to a URL, possible values are:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.UNKNOWN,</span> <span class="pre">None)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.USER,</span> <span class="pre">&quot;user</span> <span class="pre">ID&quot;)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.SEED,</span> <span class="pre">&quot;seed</span> <span class="pre">ID&quot;)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.AUTO,</span> <span class="pre">&quot;parent</span> <span class="pre">url&quot;)</span></code></li>
</ul>
</dd>
<dt>If the source is attached to a Seed, possible values are:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.UNKNOWN,</span> <span class="pre">None)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.USER,</span> <span class="pre">&quot;user</span> <span class="pre">ID&quot;)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">(SourceType.AUTO,</span> <span class="pre">None)</span></code></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.Source.extra">
<code class="descname">extra</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.Source.extra" title="Permalink to this definition">¶</a></dt>
<dd><p>A unicode string field.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.Source.type_">
<code class="descname">type_</code><a class="headerlink" href="#swisstext.mongo.abstract.generic.Source.type_" title="Permalink to this definition">¶</a></dt>
<dd><p>A unicode string field.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.generic.SourceType">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.generic.</code><code class="descname">SourceType</code><a class="reference internal" href="_modules/swisstext/mongo/abstract/generic.html#SourceType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.generic.SourceType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Possible sources for a URL or a Seed.</p>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.SourceType.AUTO">
<code class="descname">AUTO</code><em class="property"> = 'auto'</em><a class="headerlink" href="#swisstext.mongo.abstract.generic.SourceType.AUTO" title="Permalink to this definition">¶</a></dt>
<dd><p>Auto means it has been generated automatically by the system during regular execution</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.SourceType.SEED">
<code class="descname">SEED</code><em class="property"> = 'seed'</em><a class="headerlink" href="#swisstext.mongo.abstract.generic.SourceType.SEED" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL was found by searching the seed whose ID figures in source.extra</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.SourceType.UNKNOWN">
<code class="descname">UNKNOWN</code><em class="property"> = 'file'</em><a class="headerlink" href="#swisstext.mongo.abstract.generic.SourceType.UNKNOWN" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used when the seeds/urls are read from a file</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.generic.SourceType.USER">
<code class="descname">USER</code><em class="property"> = 'user'</em><a class="headerlink" href="#swisstext.mongo.abstract.generic.SourceType.USER" title="Permalink to this definition">¶</a></dt>
<dd><p>When user is set, the source.extra should contain the user id</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swisstext.mongo.abstract.seeds">
<span id="seed-collection"></span><h2>Seed collection<a class="headerlink" href="#module-swisstext.mongo.abstract.seeds" title="Permalink to this headline">¶</a></h2>
<p>Class representing a <code class="docutils literal notranslate"><span class="pre">seed</span></code> entry in the MongoDatabase.</p>
<p>A seed is a string used as a search engine query in order to find new Swiss German URLs. In the SwissText system,
seeds can be added by users or generated automatically. Each seed will potentially be used multiple times.</p>
<p>Seeds are generated automatically in <code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.crawling</span></code> and used in <a class="reference internal" href="swisstext.cmd.searching.html#module-swisstext.cmd.searching" title="swisstext.cmd.searching"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.searching</span></code></a>. Users
can also add seeds manually to the collection using the Frontend (see <code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.frontend</span></code>).</p>
<dl class="class">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.seeds.</code><code class="descname">AbstractMongoSeed</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.Document</span></code></p>
<p>An abstract <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a> for a seed, stored in the <code class="docutils literal notranslate"><span class="pre">seeds</span></code> collection.</p>
<dl class="method">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.add_search_history">
<code class="descname">add_search_history</code><span class="sig-paren">(</span><em>new_links_count</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.add_search_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.add_search_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a search history entry. This should be call after each usage of the seed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_links_count</strong> – the number of new URLs found.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.count">
<code class="descname">count</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of new URLs found. This counter is incremented on each seed use for any new URL, whether the 
URL is actually a “good URL” (i.e. really contains Swiss German) or not. This is because to determine the
quality of a URL, one need to actually crawl it.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>seed</em>, <em>source=&lt;Source: Source object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a seed. <em>Warning</em>: this <strong>won’t save</strong> the document automatically.
You need to call the <code class="docutils literal notranslate"><span class="pre">.save</span></code> method to persist it into the database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>seed</strong> – the seed</li>
<li><strong>source</strong> – the source of the seed, default to <code class="docutils literal notranslate"><span class="pre">SourceType.UNKNOWN</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.date_added">
<code class="descname">date_added</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.date_added" title="Permalink to this definition">¶</a></dt>
<dd><p>When the seed has been added to the collection, in UTC.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.deleted">
<code class="descname">deleted</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>This field is only present in the collection if the seed has been deleted. Use the following query
to get deleted seeds:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">seeds</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">deleted</span><span class="o">:</span> <span class="p">{</span><span class="nx">$exists</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.delta_date">
<code class="descname">delta_date</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.delta_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Date of the last use of this seed in a search.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.exists">
<em class="property">classmethod </em><code class="descname">exists</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a seed already exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>text</strong> – the seed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.find_similar">
<em class="property">classmethod </em><code class="descname">find_similar</code><span class="sig-paren">(</span><em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.find_similar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.find_similar" title="Permalink to this definition">¶</a></dt>
<dd><p>Find similar seeds. Currently, this method is quite <em>dumb</em>: it will search for seeds containing one or
more words present in <cite>seed</cite> using regex.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the actual regex for a seed like <em>hello world</em> will use the regex <code class="docutils literal notranslate"><span class="pre">(hello)|(world)</span></code>, so
a seed like <em>worldnews</em> may also be included in the results.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>seed</strong> – the seed to search for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.BaseQuery</span></code> object for other seeds containing similar words.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a seed by ID.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.id">
<code class="descname">id</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The seed itself is used as an primary key to avoid duplicates.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">only true duplicates are detected, so ensure the seed is lowercase and trimed before insert.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.mark_deleted">
<em class="property">classmethod </em><code class="descname">mark_deleted</code><span class="sig-paren">(</span><em>obj</em>, <em>uuid</em>, <em>comment=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.mark_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.mark_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark one or multiple seeds as deleted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – either a seed ID (i.e. a string), a <code class="docutils literal notranslate"><span class="pre">MongoSeed</span></code> instance or a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> of seeds.</li>
<li><strong>uuid</strong> – the ID of the user deleting the seed.</li>
<li><strong>comment</strong> – an optional comment</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.search_history">
<code class="descname">search_history</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.search_history" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of usage. For each use, we record the date and the number of new URLs found. The sum of each
search history <code class="docutils literal notranslate"><span class="pre">count</span></code> should be equal to the <code class="docutils literal notranslate"><span class="pre">count</span></code> variable.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.source">
<code class="descname">source</code><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.source" title="Permalink to this definition">¶</a></dt>
<dd><p>Source of the seed. Possible values are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">SourceType.AUTO</span></code> or <code class="docutils literal notranslate"><span class="pre">SourceType.UNKNOWN</span></code>: no extra required,</li>
<li><code class="docutils literal notranslate"><span class="pre">SourceType.USER</span></code>: the extra is the id of the user.</li>
</ul>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.seeds.AbstractMongoSeed.unmark_deleted">
<em class="property">classmethod </em><code class="descname">unmark_deleted</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/seeds.html#AbstractMongoSeed.unmark_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.seeds.AbstractMongoSeed.unmark_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Undelete a seed. This will <em>unset</em> the <code class="docutils literal notranslate"><span class="pre">deleted</span></code> flag completely. In Mongo Shell, use:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">seeds</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">_id</span><span class="o">:</span> <span class="s2">&quot;the seed&quot;</span><span class="p">},</span> <span class="p">{</span><span class="nx">$unset</span><span class="o">:</span> <span class="p">{</span><span class="nx">deleted_by</span><span class="o">:</span><span class="mi">1</span><span class="p">}})</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>obj</strong> – either a seed ID (i.e. a string), a <code class="docutils literal notranslate"><span class="pre">MongoSeed</span></code> instance or a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> of seeds.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swisstext.mongo.abstract.sentences">
<span id="sentences-collection"></span><h2>Sentences collection<a class="headerlink" href="#module-swisstext.mongo.abstract.sentences" title="Permalink to this headline">¶</a></h2>
<p>Classes for interacting with a Swiss German <code class="docutils literal notranslate"><span class="pre">sentence</span></code> in the MongoDatabase.</p>
<p>Sentences are unique and found automatically using the swisstext crawler (see <a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping" title="swisstext.cmd.scraping"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.scraping</span></code></a>).
Once a sentence is added to the collection, it is never deleted, except if the URL it comes from is blacklisted.</p>
<p>Using the SwissText Frontend (see <code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.frontend</span></code>), users can:</p>
<ul class="simple">
<li>validate the sentence: i.e. mark it as actually Swiss German,</li>
<li>label the sentence: assign a dialect (see <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo" title="swisstext.mongo.abstract.sentences.DialectInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">DialectInfo</span></code></a>) to it,</li>
<li>delete a sentence: this will just add a deleted flag, not actually remove the sentence from the collection.</li>
</ul>
<dl class="class">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.sentences.</code><code class="descname">AbstractMongoSentence</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.Document</span></code></p>
<p>An abstract <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a> for a sentence, stored in the <code class="docutils literal notranslate"><span class="pre">sentence</span></code> collection.</p>
<p>To avoid duplicates, the primary key is a hash derived from the text. We currently use
<a class="reference external" href="https://opensource.googleblog.com/2011/04/introducing-cityhash.html">CityHash64</a>, a hashing function
especially made for hashtables instead of cryptography. Note that the hash is case-sensitive and that
the text should be trimed before hashing (by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">string.trim()</span></code> for example).
There is also no guarantee that there won’t be clashes.</p>
<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.add_label">
<em class="property">classmethod </em><code class="descname">add_label</code><span class="sig-paren">(</span><em>obj</em>, <em>uuid</em>, <em>label</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.add_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.add_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a dialect label. This method first ensures that the <a class="reference internal" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.dialect" title="swisstext.mongo.abstract.sentences.AbstractMongoSentence.dialect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dialect</span></code></a> attribute is not null, then
forwards the call to <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.add_label" title="swisstext.mongo.abstract.sentences.DialectInfo.add_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectInfo.add_label()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – either the ID of a sentence (a string) or an actual sentence.</li>
<li><strong>uuid</strong> – the ID of the user labelling the sentence.</li>
<li><strong>label</strong> – the label (see <a class="reference internal" href="#swisstext.mongo.abstract.generic.Dialects" title="swisstext.mongo.abstract.generic.Dialects"><code class="xref py py-const docutils literal notranslate"><span class="pre">Dialects</span></code></a>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.crawl_proba">
<code class="descname">crawl_proba</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.crawl_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>The probability of Swiss German, as calculated by the LID model during crawl.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>text</em>, <em>url</em>, <em>proba</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a seed. <em>Warning</em>: this <strong>won’t save</strong> the document automatically.
You need to call the <code class="docutils literal notranslate"><span class="pre">.save</span></code> method to persist it into the database.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.date_added">
<code class="descname">date_added</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.date_added" title="Permalink to this definition">¶</a></dt>
<dd><p>The date when the sentence was added to the collection, in UTC.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.deleted">
<code class="descname">deleted</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>A deleted flag (with date, user ID and optional comment) that exists only if the sentence is deleted.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.dialect">
<code class="descname">dialect</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.dialect" title="Permalink to this definition">¶</a></dt>
<dd><p>All the informations about dialect tagging (see <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo" title="swisstext.mongo.abstract.sentences.DialectInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">DialectInfo</span></code></a>). 
Note that this field can be absent (never labelled by anyone) or its label empty (all labels removed).</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.exists">
<em class="property">classmethod </em><code class="descname">exists</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a sentence already exists (case sensitive).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.get_hash">
<em class="property">static </em><code class="descname">get_hash</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.get_hash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.get_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Hash the given text using
<a class="reference external" href="https://opensource.googleblog.com/2011/04/introducing-cityhash.html">CityHash64</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.id">
<code class="descname">id</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The sentence ID, computed by hashing the text using <a class="reference internal" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.get_hash" title="swisstext.mongo.abstract.sentences.AbstractMongoSentence.get_hash"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_hash()</span></code></a>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.mark_deleted">
<em class="property">classmethod </em><code class="descname">mark_deleted</code><span class="sig-paren">(</span><em>obj</em>, <em>uuid</em>, <em>comment=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.mark_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.mark_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a sentence as deleted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – either the ID of a sentence (a string) or an actual sentence.</li>
<li><strong>uuid</strong> – the ID of the user deleting the sentence.</li>
<li><strong>comment</strong> – an optional comment.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.remove_label">
<em class="property">classmethod </em><code class="descname">remove_label</code><span class="sig-paren">(</span><em>obj</em>, <em>uuid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.remove_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.remove_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a label added by a user. This method just forwards the call to <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.add_label" title="swisstext.mongo.abstract.sentences.DialectInfo.add_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectInfo.add_label()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> – either the ID of a sentence (a string) or an actual sentence.</li>
<li><strong>uuid</strong> – the ID of the user for which to remove the label.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.text">
<code class="descname">text</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.text" title="Permalink to this definition">¶</a></dt>
<dd><p>The raw text, without any transformations except trim.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.unmark_deleted">
<em class="property">classmethod </em><code class="descname">unmark_deleted</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#AbstractMongoSentence.unmark_deleted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.unmark_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore a deleted sentence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>obj</strong> – either the ID of a sentence (a string) or an actual sentence.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.url">
<code class="descname">url</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.url" title="Permalink to this definition">¶</a></dt>
<dd><p>The source URL.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.AbstractMongoSentence.validated_by">
<code class="descname">validated_by</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.AbstractMongoSentence.validated_by" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of user ID that have seen the sentence and validated it as Swiss German in the Frontend.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.sentences.DialectEntry">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.sentences.</code><code class="descname">DialectEntry</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectEntry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectEntry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.EmbeddedDocument</span></code></p>
<p>Represents a <em>vote</em>, i.e. dialect label, assigned by a user.</p>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectEntry.date">
<code class="descname">date</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectEntry.date" title="Permalink to this definition">¶</a></dt>
<dd><p>The date of the vote, in UTC</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectEntry.label">
<code class="descname">label</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectEntry.label" title="Permalink to this definition">¶</a></dt>
<dd><p>The label (see <a class="reference internal" href="#swisstext.mongo.abstract.generic.Dialects" title="swisstext.mongo.abstract.generic.Dialects"><code class="xref py py-const docutils literal notranslate"><span class="pre">swisstext.mongo.abstract.generic.Dialects</span></code></a> for a list of available labels)</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectEntry.user">
<code class="descname">user</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectEntry.user" title="Permalink to this definition">¶</a></dt>
<dd><p>The ID of the user</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.sentences.</code><code class="descname">DialectInfo</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.EmbeddedDocument</span></code></p>
<p>A <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.EmbeddedDocument" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.EmbeddedDocument</span></code></a> that Encapsulates all the dialect-tagging information for a sentence.</p>
<p>Usually, a sentence will be presented to a given user only once. If the user knows the dialect, an
entry in <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.labels" title="swisstext.mongo.abstract.sentences.DialectInfo.labels"><code class="xref py py-attr docutils literal notranslate"><span class="pre">labels</span></code></a> is added. If the user doesn’t know, his ID is added to <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.skipped_by" title="swisstext.mongo.abstract.sentences.DialectInfo.skipped_by"><code class="xref py py-attr docutils literal notranslate"><span class="pre">skipped_by</span></code></a>.
Thus, a user ID should be present <em>at most</em> in one of the two lists.</p>
<p>The current dialect is stored in <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.label" title="swisstext.mongo.abstract.sentences.DialectInfo.label"><code class="xref py py-attr docutils literal notranslate"><span class="pre">label</span></code></a>. In order to judge the pertinence of the former,
two statistics can be used: <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.count" title="swisstext.mongo.abstract.sentences.DialectInfo.count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">count</span></code></a> is the total number of users having voted for the label,
while <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.confidence" title="swisstext.mongo.abstract.sentences.DialectInfo.confidence"><code class="xref py py-attr docutils literal notranslate"><span class="pre">confidence</span></code></a> is the ratio between the number of votes for this label and the total number of votes.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Most of the methods here call <code class="xref py py-meth docutils literal notranslate"><span class="pre">mongoengine.EmbeddedDocument.save()</span></code> under the hood, thus persisting
the changes automatically to the DB.</p>
<p>This usually works fine, but this means you CAN NOT manipulate a
<code class="docutils literal notranslate"><span class="pre">DialectInfo</span></code> instance if it is not attached to a <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a>.</p>
<p>Moreover, you can sometimes run into a
‘<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ReferenceError" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReferenceError</span></code></a>: <em>weakly-referenced object no longer exists’</em>
(only when using Flask-Mongoengine ?). If this is the case, ensure that you have a strong reference to the
parent document in your code. Here is an example:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s say MongoSentence implements AbstractMongoSentence</span>
<span class="c1"># This can raise a ReferenceException:</span>
<span class="n">MongoSentence</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">with_id</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="c1"># while this is fine:</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">MongoSentence</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">with_id</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">uuid</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="c1"># OK</span>
</pre></div>
</div>
</div>
<dl class="method">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.add_label">
<code class="descname">add_label</code><span class="sig-paren">(</span><em>uuid</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo.add_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.add_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a label and save the document. Note the following two special cases:
1. the user has already voted: the old vote will be deleted / replaced
2. the user has previously skipped the sentence: the user ID will be removed from <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.skipped_by" title="swisstext.mongo.abstract.sentences.DialectInfo.skipped_by"><code class="xref py py-attr docutils literal notranslate"><span class="pre">skipped_by</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>uuid</strong> – the user ID</li>
<li><strong>label</strong> – the label</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">self</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.confidence">
<code class="descname">confidence</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.confidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Defined by <code class="docutils literal notranslate"><span class="pre">count</span> <span class="pre">/</span> <span class="pre">len(labels)</span></code>. Gives a rough estimate of how “<em>good</em>” a label is.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.count">
<code class="descname">count</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of people that voted for the current label.</p>
</dd></dl>

<dl class="method">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.get_label_by">
<code class="descname">get_label_by</code><span class="sig-paren">(</span><em>uuid</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo.get_label_by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.get_label_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the label given by a user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uuid</strong> – the user ID</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the label as a string, or None if the user hasn’t labelled the sentence.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.label">
<code class="descname">label</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Current label, i.e. the label with the highest number of votes. 
In case of a draw, one label is selected randomly. This is why the <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.confidence" title="swisstext.mongo.abstract.sentences.DialectInfo.confidence"><code class="xref py py-attr docutils literal notranslate"><span class="pre">confidence</span></code></a> information
is important.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.labels">
<code class="descname">labels</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.labels" title="Permalink to this definition">¶</a></dt>
<dd><p>All the votes, as a list of  <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectEntry" title="swisstext.mongo.abstract.sentences.DialectEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">DialectEntry</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.remove_label">
<code class="descname">remove_label</code><span class="sig-paren">(</span><em>uuid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo.remove_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.remove_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the label from a user and save the change to MongoDb.
Note that it does nothing if the user didn’t vote.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uuid</strong> – the user ID</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.skip">
<code class="descname">skip</code><span class="sig-paren">(</span><em>uuid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo.skip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.skip" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the user to the <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.skipped_by" title="swisstext.mongo.abstract.sentences.DialectInfo.skipped_by"><code class="xref py py-attr docutils literal notranslate"><span class="pre">skipped_by</span></code></a> list. Note that if the user already voted, his vote will be removed
from <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.labels" title="swisstext.mongo.abstract.sentences.DialectInfo.labels"><code class="xref py py-attr docutils literal notranslate"><span class="pre">labels</span></code></a> to ensure consistency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uuid</strong> – the user ID</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.skipped_by">
<code class="descname">skipped_by</code><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.skipped_by" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of User ID, corresponding to users having seen the sentence, but were not able to label it.</p>
</dd></dl>

<dl class="method">
<dt id="swisstext.mongo.abstract.sentences.DialectInfo.unskip">
<code class="descname">unskip</code><span class="sig-paren">(</span><em>uuid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/sentences.html#DialectInfo.unskip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.sentences.DialectInfo.unskip" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a user from the <a class="reference internal" href="#swisstext.mongo.abstract.sentences.DialectInfo.skipped_by" title="swisstext.mongo.abstract.sentences.DialectInfo.skipped_by"><code class="xref py py-attr docutils literal notranslate"><span class="pre">skipped_by</span></code></a> list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uuid</strong> – the user ID</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swisstext.mongo.abstract.urls">
<span id="urls-and-blacklist-collections"></span><h2>URLs and Blacklist collections<a class="headerlink" href="#module-swisstext.mongo.abstract.urls" title="Permalink to this headline">¶</a></h2>
<p>Classes for interacting with URLs in the MongoDatabase.</p>
<p>All visited URLs must be recorded in some way in the database, at least to avoid recawling over and over the same
links. Thus, URLs are splitted into two collections:</p>
<ul class="simple">
<li><cite>urls</cite>: stores <em>interesting</em> URLs that could/should be crawled again,</li>
<li><cite>blacklist</cite>: stores URLs that should never by visited again.</li>
</ul>
<p>At the time of writing, <a class="reference internal" href="swisstext.cmd.scraping.html#module-swisstext.cmd.scraping" title="swisstext.cmd.scraping"><code class="xref py py-mod docutils literal notranslate"><span class="pre">swisstext.cmd.scraping</span></code></a> defines interesting URLs as URLs with at least one
Swiss German sentence.</p>
<p>Also note that URLs that have never been visited can also be stored in the <cite>urls</cite> collection. They will be
updated or moved to the <cite>blacklist</cite> after the first visit.</p>
<dl class="class">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.urls.</code><code class="descname">AbstractMongoBlacklist</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoBlacklist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.Document</span></code></p>
<p>An abstract <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a> for <em>uninteresting</em> URLs, stored in the <code class="docutils literal notranslate"><span class="pre">blacklist</span></code> collection.</p>
<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist.add_url">
<em class="property">classmethod </em><code class="descname">add_url</code><span class="sig-paren">(</span><em>url: str</em>, <em>source: swisstext.mongo.abstract.generic.Source = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoBlacklist.add_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist.add_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Blacklist a URL. This will create and save the entry to mongo automatically.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist.date_added">
<code class="descname">date_added</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist.date_added" title="Permalink to this definition">¶</a></dt>
<dd><p>When the URL was added to the blacklist</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist.exists">
<em class="property">classmethod </em><code class="descname">exists</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoBlacklist.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a url is blacklisted.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist.source">
<code class="descname">source</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist.source" title="Permalink to this definition">¶</a></dt>
<dd><p>What/who triggered the blacklisting, see <a class="reference internal" href="#swisstext.mongo.abstract.generic.Source" title="swisstext.mongo.abstract.generic.Source"><code class="xref py py-class docutils literal notranslate"><span class="pre">swisstext.mongo.abstract.generic.Source</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoBlacklist.url">
<code class="descname">url</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoBlacklist.url" title="Permalink to this definition">¶</a></dt>
<dd><p>The blacklisted URL, acting as a primary key.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.urls.</code><code class="descname">AbstractMongoURL</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.Document</span></code></p>
<p>An abstract <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.Document</span></code></a> for <em>interesting</em> URLs, stored in the <code class="docutils literal notranslate"><span class="pre">urls</span></code> collection.</p>
<dl class="method">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.add_crawl_history">
<code class="descname">add_crawl_history</code><span class="sig-paren">(</span><em>new_sg_count</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.add_crawl_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.add_crawl_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a crawl history entry. Note that this will update the document instance,
but won’t persist the change to mongo. You need to call <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.Document.save" title="(in MongoEngine v0.15.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mongoengine.Document.save()</span></code></a> yourself.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_sg_count</strong> – the number of new sentences found on this crawl.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.count">
<code class="descname">count</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of new sentences found on this page in all visit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AbstractMongoURL</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">((</span><span class="n">ch</span><span class="o">.</span><span class="n">count</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">AbstractMongoURL</span><span class="o">.</span><span class="n">crawl_history</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.crawl_history">
<code class="descname">crawl_history</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.crawl_history" title="Permalink to this definition">¶</a></dt>
<dd><p>One entry for each visit of this URL by the scraper, ordered by the visit date ascending.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>url</em>, <em>source=&lt;Source: Source object&gt;</em><span class="sig-paren">)</span> &#x2192; mongoengine.document.Document<a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a URL. <em>Warning</em>: this <strong>won’t save</strong> the document automatically.
You need to call the <code class="docutils literal notranslate"><span class="pre">.save</span></code> method to persist it into the database.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.date_added">
<code class="descname">date_added</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.date_added" title="Permalink to this definition">¶</a></dt>
<dd><p>When the URL was added to the collection, in UTC.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.delta">
<code class="descname">delta</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of new sentences found on the last visit (same as <code class="docutils literal notranslate"><span class="pre">crawl_history[-1].count</span></code>).</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.delta_date">
<code class="descname">delta_date</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.delta_date" title="Permalink to this definition">¶</a></dt>
<dd><p>The date of the last visit (same as <code class="docutils literal notranslate"><span class="pre">crawl_history[-1].date</span></code>). Inexistant if the URL was never crawled.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.exists">
<em class="property">classmethod </em><code class="descname">exists</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a URL exists.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span> &#x2192; object<a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a URL Document instance by ID.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.get_never_crawled">
<em class="property">classmethod </em><code class="descname">get_never_crawled</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; mongoengine.queryset.queryset.QuerySet<a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.get_never_crawled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.get_never_crawled" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a <a class="reference external" href="http://docs.mongoengine.org/apireference.html#mongoengine.queryset.QuerySet" title="(in MongoEngine v0.15.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a> of URLs that have never been visited.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.id">
<code class="descname">id</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The URL, also used as a primary key.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.source">
<code class="descname">source</code><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.source" title="Permalink to this definition">¶</a></dt>
<dd><p>The source of the URL (see <a class="reference internal" href="#swisstext.mongo.abstract.generic.Source" title="swisstext.mongo.abstract.generic.Source"><code class="xref py py-class docutils literal notranslate"><span class="pre">Source</span></code></a>). 
Possible sources are defined in <a class="reference internal" href="#swisstext.mongo.abstract.generic.SourceType" title="swisstext.mongo.abstract.generic.SourceType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceType</span></code></a>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swisstext.mongo.abstract.urls.AbstractMongoURL.try_delete">
<em class="property">classmethod </em><code class="descname">try_delete</code><span class="sig-paren">(</span><em>url: str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/urls.html#AbstractMongoURL.try_delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.urls.AbstractMongoURL.try_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a URL if it exists. Otherwise, do nothing silently.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swisstext.mongo.abstract.users">
<span id="users-collection"></span><h2>Users collection<a class="headerlink" href="#module-swisstext.mongo.abstract.users" title="Permalink to this headline">¶</a></h2>
<p>Classes for interacting with Users in the MongoDatabase.</p>
<p>A user has a username and a password, as well as a list of possible roles to fine-grain the access to the frontend.</p>
<dl class="class">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.users.</code><code class="descname">AbstractMongoUser</code><span class="sig-paren">(</span><em>*args</em>, <em>**values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/users.html#AbstractMongoUser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">mongoengine.document.Document</span></code></p>
<dl class="classmethod">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>uuid: str</em>, <em>password: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/swisstext/mongo/abstract/users.html#AbstractMongoUser.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a user. If password is specified, it is checked against the one in the database (login).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>uuid</strong> – the username / ID</li>
<li><strong>password</strong> – the clear password</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">either a user instance or None if the uuid does not exist or the password was specified and incorrect.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser.get_hash">
<em class="property">static </em><code class="descname">get_hash</code><span class="sig-paren">(</span><em>password</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/swisstext/mongo/abstract/users.html#AbstractMongoUser.get_hash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser.get_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the MD5 hash of the password.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser.id">
<code class="descname">id</code><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The user ID, which is also the username.</p>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser.password">
<code class="descname">password</code><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser.password" title="Permalink to this definition">¶</a></dt>
<dd><p>The password, hashed using MD5.</p>
<p>In python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
<p>In Mongo Shell:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">hex_md5</span><span class="p">(</span><span class="nx">password</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.users.AbstractMongoUser.roles">
<code class="descname">roles</code><a class="headerlink" href="#swisstext.mongo.abstract.users.AbstractMongoUser.roles" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of roles. If the list is empty, the user is considered a <a class="reference internal" href="#swisstext.mongo.abstract.users.UserRoles.USER" title="swisstext.mongo.abstract.users.UserRoles.USER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">USER</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swisstext.mongo.abstract.users.UserRoles">
<em class="property">class </em><code class="descclassname">swisstext.mongo.abstract.users.</code><code class="descname">UserRoles</code><a class="reference internal" href="_modules/swisstext/mongo/abstract/users.html#UserRoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#swisstext.mongo.abstract.users.UserRoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Currently, users can either be <a class="reference internal" href="#swisstext.mongo.abstract.users.UserRoles.ADMIN" title="swisstext.mongo.abstract.users.UserRoles.ADMIN"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ADMIN</span></code></a> or <a class="reference internal" href="#swisstext.mongo.abstract.users.UserRoles.USER" title="swisstext.mongo.abstract.users.UserRoles.USER"><code class="xref py py-attr docutils literal notranslate"><span class="pre">USER</span></code></a>.</p>
<dl class="attribute">
<dt id="swisstext.mongo.abstract.users.UserRoles.ADMIN">
<code class="descname">ADMIN</code><em class="property"> = 'admin'</em><a class="headerlink" href="#swisstext.mongo.abstract.users.UserRoles.ADMIN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swisstext.mongo.abstract.users.UserRoles.USER">
<code class="descname">USER</code><em class="property"> = 'user'</em><a class="headerlink" href="#swisstext.mongo.abstract.users.UserRoles.USER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">MongoDB Collections definitions</a><ul>
<li><a class="reference internal" href="#module-swisstext.mongo.abstract.generic">Common structures and embedded documents</a></li>
<li><a class="reference internal" href="#module-swisstext.mongo.abstract.seeds">Seed collection</a></li>
<li><a class="reference internal" href="#module-swisstext.mongo.abstract.sentences">Sentences collection</a></li>
<li><a class="reference internal" href="#module-swisstext.mongo.abstract.urls">URLs and Blacklist collections</a></li>
<li><a class="reference internal" href="#module-swisstext.mongo.abstract.users">Users collection</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="swisstext.mongo.html"
                        title="previous chapter">MongoEngine - MongoDB package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="swisstext.cmd.html"
                        title="next chapter">Commandline tools</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/swisstext.mongo.abstract.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="swisstext.cmd.html" title="Commandline tools"
             >next</a> |</li>
        <li class="right" >
          <a href="swisstext.mongo.html" title="MongoEngine - MongoDB package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SwissText  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="apireference.html" >API Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="swisstext.mongo.html" >MongoEngine - MongoDB package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Lucy Linder.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>